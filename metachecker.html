<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Meta-Checker Tool ‚Äì √úberpr√ºfen Sie Meta-Tags, SEO-Daten und Social Previews von Webseiten.">
  <title>Meta-Checker | Media Aachen</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #2563eb;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      animation: spin 0.8s linear infinite;
      display: inline-block;
    }
    @keyframes spin { 0% {transform: rotate(0deg);} 100% {transform: rotate(360deg);} }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Header -->
  <header class="bg-white shadow sticky top-0 z-50">
    <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
      <a href="index.html" class="text-2xl font-bold text-blue-600">SEO Experte Aachen</a>
      <a href="index.html" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition">
        ‚¨ÖÔ∏è Zur√ºck
      </a>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-5xl mx-auto py-12 px-6">
    <h1 class="text-3xl sm:text-4xl font-bold mb-6 text-center">üîç Meta-Checker Tool</h1>
    <p class="text-center mb-8">√úberpr√ºfen Sie die wichtigsten SEO-Daten, Meta-Tags und Social Previews einer Webseite.</p>

    <!-- Formular -->
    <form id="checker-form" class="flex flex-col sm:flex-row gap-3 mb-8">
      <input type="url" id="url" placeholder="https://example.com"
        class="flex-1 border rounded-lg px-4 py-3 shadow-sm text-base focus:outline-none focus:ring-2 focus:ring-blue-600"
        required>
      <button type="submit" id="checkBtn"
        class="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg shadow hover:bg-blue-700 transition disabled:opacity-70 disabled:cursor-not-allowed">
        <span id="btnText">üöÄ Pr√ºfen</span>
      </button>
    </form>

    <div id="results" class="space-y-10"></div>
  </main>

  <!-- Ladeoverlay -->
  <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center hidden z-50">
    <div id="overlayContent" class="bg-white rounded-lg shadow-lg p-6 flex flex-col items-center w-80">
      <div class="spinner mb-3"></div>
      <p class="text-gray-700 font-semibold mb-4">Wird geladen‚Ä¶</p>
      <div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
        <div id="progressBar" class="bg-blue-600 h-2 w-0"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-6 mt-16">
    <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
      <p>¬© 2025 SEO Experte Aachen ‚Äì Alle Rechte vorbehalten.</p>
      <div class="space-x-4">
        <a href="impressum.html" class="hover:underline">Impressum</a>
        <a href="datenschutz.html" class="hover:underline">Datenschutzerkl√§rung</a>
      </div>
    </div>
  </footer>

  <script>
    // Helferfunktionen
    function checkLength(text, min, max) {
      if (!text) return '<span class="text-red-600 font-semibold">‚ùå fehlt</span>';
      if (text.length < min) return `<span class="text-yellow-600 font-semibold">‚ö†Ô∏è zu kurz (${text.length} Zeichen)</span>`;
      if (text.length > max) return `<span class="text-yellow-600 font-semibold">‚ö†Ô∏è zu lang (${text.length} Zeichen)</span>`;
      return `<span class="text-green-600 font-semibold">‚úÖ ok (${text.length} Zeichen)</span>`;
    }

    function checkCount(name, count, min, max) {
      if (count === 0) return `<span class="text-red-600 font-semibold">‚ùå ${name} fehlt</span>`;
      if (min !== null && count < min) return `<span class="text-yellow-600 font-semibold">‚ö†Ô∏è ${name} zu wenig (${count})</span>`;
      if (max !== null && count > max) return `<span class="text-yellow-600 font-semibold">‚ö†Ô∏è ${name} zu viele (${count})</span>`;
      return `<span class="text-green-600 font-semibold">‚úÖ ${name} ok (${count})</span>`;
    }

    function calculateSeoScore(data) {
      let score = 0;
      let maxScore = 10;
      if (data.title && data.title.length >= 10 && data.title.length <= 60) score++;
      if (data.description && data.description.length >= 50 && data.description.length <= 160) score++;
      if (data.ogImage) score++;
      if (data.twitterImage) score++;
      if (data.canonical) score++;
      if (data.robots) score++;
      if (data.author) score++;
      if (data.headings?.h1?.length === 1) score++;
      if ((data.headings?.h2?.length || 0) >= 2) score++;
      if ((data.bold?.length || 0) >= 3 && (data.bold?.length || 0) <= 15) score++;
      return Math.round((score / maxScore) * 100);
    }

    async function animateProgress() {
      const bar = document.getElementById("progressBar");
      if (!bar) return null;
      bar.style.width = "0%";
      let width = 0;
      return setInterval(() => {
        width += Math.random() * 15;
        if (width >= 95) width = 95;
        bar.style.width = width + "%";
      }, 400);
    }

    // Formular-Event
    document.getElementById("checker-form")?.addEventListener("submit", async (e) => {
      e.preventDefault();
      const btn = document.getElementById("checkBtn");
      const btnText = document.getElementById("btnText");
      const overlay = document.getElementById("loadingOverlay");
      const url = document.getElementById("url").value;

      btn.disabled = true;
      btnText.textContent = "Pr√ºfen...";
      overlay.classList.remove("hidden");

      let progressInterval = await animateProgress();

      try {
        const res = await fetch("https://api.allorigins.win/get?url=" + encodeURIComponent(url));
        const data = await res.json();
        const html = data.contents;

        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");

        const parsedData = {
          title: doc.querySelector("title")?.innerText || "",
          description: doc.querySelector("meta[name='description']")?.content || "",
          canonical: doc.querySelector("link[rel='canonical']")?.href || "",
          robots: doc.querySelector("meta[name='robots']")?.content || "",
          author: doc.querySelector("meta[name='author']")?.content || "",
          ogImage: doc.querySelector("meta[property='og:image']")?.content || "",
          ogTitle: doc.querySelector("meta[property='og:title']")?.content || "",
          ogDescription: doc.querySelector("meta[property='og:description']")?.content || "",
          twitterImage: doc.querySelector("meta[name='twitter:image']")?.content || "",
          twitterTitle: doc.querySelector("meta[name='twitter:title']")?.content || "",
          twitterDescription: doc.querySelector("meta[name='twitter:description']")?.content || "",
          headings: {
            h1: [...doc.querySelectorAll("h1")].map(h => h.innerText),
            h2: [...doc.querySelectorAll("h2")].map(h => h.innerText),
            h3: [...doc.querySelectorAll("h3")].map(h => h.innerText),
          },
          bold: [...doc.querySelectorAll("b,strong")].map(b => b.innerText)
        };

        // Score
        const seoScore = calculateSeoScore(parsedData);
        const circleRadius = 50;
        const circumference = 2 * Math.PI * circleRadius;
        const offset = circumference - (seoScore / 100) * circumference;

        // Ergebnisse
        const results = `
          <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div class="bg-white border-l-4 border-blue-600 shadow p-4">
              <h2 class="text-lg font-semibold mb-2">üîé Struktur-Analyse</h2>
              <ul class="list-disc pl-6 space-y-1">
                <li>${checkCount("H1", parsedData.headings.h1.length, 1, 1)}</li>
                <li>${checkCount("H2", parsedData.headings.h2.length, 2, null)}</li>
                <li>${checkCount("H3", parsedData.headings.h3.length, 1, null)}</li>
                <li>${checkCount("Fette W√∂rter", parsedData.bold.length, 3, 15)}</li>
              </ul>
            </div>
            <div class="bg-white shadow rounded-lg p-6 flex flex-col items-center justify-center">
              <h2 class="text-lg font-bold mb-4">‚≠ê SEO Score</h2>
              <svg class="w-32 h-32 transform -rotate-90">
                <circle cx="64" cy="64" r="${circleRadius}" stroke="#e5e7eb" stroke-width="10" fill="none"/>
                <circle cx="64" cy="64" r="${circleRadius}" stroke="${seoScore >= 80 ? '#16a34a' : seoScore >= 50 ? '#facc15' : '#dc2626'}"
                  stroke-width="10" fill="none"
                  stroke-dasharray="${circumference}"
                  stroke-dashoffset="${offset}"
                  stroke-linecap="round"/>
              </svg>
              <p class="text-xl font-bold mt-2">${seoScore} / 100</p>
            </div>
          </div>
        `;

        document.getElementById("results").innerHTML = results;
        setTimeout(() => overlay.classList.add("hidden"), 500);
      } catch (err) {
        document.getElementById("results").innerHTML = `<p class="text-red-600 font-bold">‚ùå Fehler: ${err.message}</p>`;
        overlay.classList.add("hidden");
      } finally {
        btn.disabled = false;
        btnText.textContent = "üöÄ Pr√ºfen";
        if (progressInterval) clearInterval(progressInterval);
      }
    });
  </script>
</body>
</html>
